a
x \mapsto ax + b \pmod{2^{27}}
m^{-1}\equiv m^{p-2}
m
enc1_m(x)=x·m
dec1_m(y)=y·m^{-1}
enc2_a(x)=x+a
dec2_a(y)=y-a
\geq p
(\odot,\oplus,\otimes,\neg)
permutateAndXorLowestNBits_{s}(x,n)
\forall x,s,n: permutateAndXorLowestNBits_{s}^{-1}(permutateAndXorLowestNBits_{s}(x,n),n)=x
x \oplus (2^{N(x)}-1) < p
\forall y. x \odot \neg(2^{N(x)}-1) \leq y \leq x \oplus (2^{N(x)}-1) \Rightarrow N(y)=N(x)
enc3_s(x) = permutateAndXorLowestNBits_{s}(x,N(x))
dec3_s(y) = permutateAndXorLowestNBits_{s}^{-1}(y,N(y))
enc_{m,a,s}(x)=enc1_m(enc2_a(enc3_s(x)))
dec_{m,a,s}(y)=dec3_s(dec2_a(dec1_m(y)))
