0 \le M \le 2n(n-1) 
n
n
n
0 \le M \le 2n(n-1) 
n
 0 \le q \le 2n
