P
Q
C_1
C_2
\theta
\phi
P\cos \theta+Q\sin \phi=C_1
P\sin \theta+Q\cos \phi=C_2
R= \sqrt{C_1^2+C^2_2}
\psi\in[0,2\pi)
\arctan(C_2/C_1)
\phi
\theta
C_1 = R\cos\psi,\quad C_2=R\sin\psi.
\cos\psi\sin\phi+\sin\psi\cos\phi = \frac{R^2+Q^2-P^2}{2QR},
\sin(\phi+\psi)=\frac{R^2+Q^2-P^2}{2QR}.
