A(n,k):=|\{\pi\in S_n:\pi\;\mathrm{has}\;k\;\mathrm{runs}\}|
a
b
\frac{a}{a+b}
\frac{b}{a+b}
n
n+1
n+2
n
k
\frac{1}{n+1}
n
k
\frac{A(n+1,k)}{(n+1)!}
n
p(n,k)
k
n
k
n
k
n-1
n
k-1
n-1
n
k
n-1
n
\frac{k}{n+1}
k-1
n-1
n+2-k
n
\frac{n+2-k}{n+1}
1\le k\le n
p(0,1)=1
p(n,0)=0
n\ge 0
\begin{align*} p(n,k) &= p(n-1,k)\frac{k}{n+1}+p(n-1,k-1)\frac{n+2-k}{n+1}\\ &= \frac1{n+1}\left(kp(n-1,k)+(n+2-k)p(n-1,k-1)\right) \end{align*}
A(n,k)
A(n,1)=A(n,n)=1
n>0
A(n+1,k)
[n+1]
k
[n]
p(n-1,k)=\frac{A(n,k)}{n!}
p(n-1,k-1)=\frac{A(n,k-1)}{n!}
A(n+1,k)=kA(n,k)+(n+2-k)A(n,k-1)\;.
\begin{align*} p(n,k) &= \frac1{n+1}\left(k\frac{A(n,k)}{n!}+(n+2-k)\frac{A(n,k-1)}{n!}\right)\\ &= \frac{A(n+1,k)}{(n+1)!}, \end{align*}
n+1
0
n
0
i
i
i+1
\frac{1}{i+1}
n+1
0
0
0
n+1
