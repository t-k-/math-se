N,M
1 \le M \le 6
1\le N \le 36
N
M \times M
f[i,j,v_{last},v_{second\_last}]
j
i
n\times n
v_{last}
v_{second\_last}
n=5
\operatorname{popcount}(v)
v
 f[i,j,v_{last},v_{second\_last}] = \sum_{v_{third\_last}}f[i-1,j-\operatorname{popcount}(v_{last}),v_{second\_last},v_{third\_last}] 
N M 2^{2M}
2^M
O(N M 2^{3M})
q^k
m\times n
K_{m,n}(q)
k
m\times n
m\times n
