3k+1
u^2 + 3v^2
\gcd(u,v)=1
x^2 + 3y^2 = N^3
N
x = u(u^2 - 9v^2)
y = 3v(u^2 - v^2)
u
v
a^2 + 3b^2
\gcd(a,3b)=1
p = 3k+1
Q(x,y)=x^2+3y^2
p
-3
p
p
-3
x^2+3
y^2-y+1
y=\frac{x+1}{2}
y^2-y+1
-3
{\mathbb Z}_p
{\mathbb Z}_p^*
6
{\mathbb Z}_p^*
{\mathbb Z}_p^*
{\mathbb Z}_p^*
p-1
p \equiv 1 \ ({\rm mod} \ 6)
p
a^2+3b^2
{\rm gcd}(a,b)=1
p
a
b
\frac{a}{b}
{\mathbb Z}_p^*
-3
p \equiv 1 \ ({\rm mod} \ 3)
N
Q(x,y)
2
N
\frac{N}{4}
Q(x,y)
p=Q(x_0,y_0)
N
\frac{N}{p}
Q(x,y)
2
N=Q(a,b)
a
b
\frac{N}{4}=Q(\frac{a}{2},\frac{b}{2})
b \equiv a \ ({\rm mod} \ 4)
b \equiv -a \ ({\rm mod} \ 4)
\frac{N}{4}=Q(\frac{b+3a}{4},\frac{b-a}{4})
\frac{N}{4}=Q(\frac{b-3a}{4},\frac{b+a}{4})
p=Q(x_0,y_0)
N=Q(a,b)
(-y_0a+x_0b)(-y_0a-x_0b)=y_0^2a^2-x_0^2b^2
0
p
b
-b
-y_0a+x_0b \equiv 0 \ ({\rm mod} \ p)
a'=\frac{x_0a+3y_0b}{p}
b'=\frac{-y_0a+x_0b}{p}
a'
b'
\frac{N}{p}=Q(a',b')
p
p
p \equiv 1 \ ({\rm mod} \ 3)
v
v^2 \equiv -3 \ ({\rm mod} \ p)
1
p
N=v^2+3\times 1^2
N
1
3
2
Q(x,y)
N
p
p
Q(x,y)
p=Q(x,y)=Q(x',y')
-yx'+xy' \equiv 0 \ ({\rm mod} \ p)
a'=\frac{xx'+3yy'}{p}
b'=\frac{-yx'+xy'}{p}
a'
b'
1=Q(a',b')
a'=\pm 1, b'=0
x'=\pm x, y'=\pm y
Q(x,y)
Q(x,y)Q(x',y')=Q(xx'-3yy',xy'+yx')
N=Q(x,y)
1
3
Q(x,y)
N=Q(u,v)
N^2=Q(u,v)Q(u,v)=Q(u^2-3v^2,2uv)
N^3=Q(u,v)Q(u^2-3v^2,2uv)=Q(u(u^2-3v^2)-3v(2uv),v(u^2-3v^2)+u(2uv))= Q(u(u^2-9v^2),3v(u^2-v^2))
