\|x\|_A^2:= x^TAx
(x,y)_M := y^TMx
A
M
Ax=b
\frac{\|e_k\|^2_A - \|e_{k+1}\|_A^2}{\|e_k\|_A^2} = \frac{(y_k,y_k)_M^2}{(M^{-1}Ay_k,y_k)_M(A^{-1}My_k,y_k)_M}
e_k=x-x_k
y_k=M^{-1}r_k
r_k=b-Ax_k
e_{k+1} = (I-M^{-1}A)e_k
I
\|e_{k+1}\|^2_A= e_k^Tr_k - e_k^T Ay_k - r_k^T M^{-1}Ae_k + y_k^T AM^{-1}Ae_k
\frac{\|e_k\|^2_A - \|e_{k+1}\|_A^2}{\|e_k\|_A^2}\cdot (M^{-1}Ay_k,y_k)_M(A^{-1}My_k,y_k)_M = (y_k,y_k)_M^2
x_k
A
x_{k+1}
y_k=M^{-1}r_k
x_{k+1}=x_k+\alpha_k y_k
e_{k+1}=e_k-\alpha_k y_k
\alpha_k=y_k^Tr_k/y_k^TAy_k
y_k^Tr_k=y_k^TMy_k
e_k^TAe_k=r_k^TA^{-1}r_k=y_k^TM^TA^{-1}My_k
M
 \|e_{k+1}\|_A^2 = \|e_k\|_A^2-2\alpha_ky_k^Tr_k+\alpha_k^2y_k^TAy_k, 
 \begin{split} \|e_{k+1}\|_A^2 &= \|e_k^2\|_A^2-2\left(\frac{y_k^Tr_k}{y_k^TAy_k}\right)y_k^Tr_k+\left(\frac{y_k^Tr_k}{y_k^TAy_k}\right)^2y_k^TAy_k\\ &=\|e_k\|_A^2-\frac{2(y_k^Tr_k)^2-(y_k^Tr_k)^2}{y_k^TAy_k} =\|e_k\|_A^2-\frac{(y_k^Tr_k)^2}{y_k^TAy_k} \end{split} 
 \|e_k\|_A^2-\|e_{k+1}\|_A^2=\frac{(y_k^Tr_k)^2}{y_k^TAy_k} 
 \frac{\|e_k\|_A^2-\|e_{k+1}\|_A^2}{\|e_k\|_A^2}=\frac{(y_k^Tr_k)^2}{(y_k^TAy_k)(e_k^TAe_k)}. 
 \frac{\|e_k\|_A^2-\|e_{k+1}\|_A^2}{\|e_k\|_A^2}=\frac{(y_k^TMy_k)^2}{(y_k^TAy_k)(y_k^TM^TA^{-1}My_k)}. 
M
(x,y)_M=y^TMy
 \frac{\|e_k\|_A^2-\|e_{k+1}\|_A^2}{\|e_k\|_A^2}=\frac{(y_k,y_k)_M^2}{(M^{-1}Ay_k,y_k)_M(A^{-1}My_k,y_k)_M}, 
M
(x,y)_M=y^TMx
y_k^TM^TA^{-1}My_k
(A^{-1}My_k,y_k)_{M^T}
(A^{-1}My_k,y_k)_{M}
