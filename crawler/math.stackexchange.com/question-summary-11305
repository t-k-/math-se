p \equiv 1\pmod{4}
x^2-py^2=1
x
y
{x_0}^2-p{y_0}^2=1
y_0>0
y_0
gcd(x_0+1,x_0-1)=2
x_0-1=2pu^2
x_0+1=2v^2
x_0-1=2u^2
x_0+1=2pv^2
v^2-pu^2=1
|u|<y_0
y_o
u^2-pv^2=-1
p\equiv 1\pmod{4}
x^2-py^2=-1
0
1
4
x^2
y^2
0,1
4
x^2-py^2=1
x^2-y^2=1
x^2\equiv 1
y^2\equiv 0
x
y
x_0
x_0-1
x_0+1
2
(x_0+1)-(x_0-1)=2
u,v
y_0
y_0
y_0=2uv
u,v
y_0
(x_0-1)(x_0+1)=p{y_0}^2=4pu^2v^2=(2v^2)(2pu^2)
(x_0+1),(x_0-1)
(2u^2),(2pv^2)
2
u
v
p
u
v
\frac{x_0+1}{2p}
\frac{x_0-1}{2}
\frac{x_0+1}{2}
\frac{x_0-1}{2p}
