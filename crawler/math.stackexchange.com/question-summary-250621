 \frac{(N+M)!}{N!M!} 
 \frac{(x+y)!}{x!y!}\frac{[(M+N)-(x+y)]!}{(M-x)!(N-y)!} 
 \frac{(N+M)!}{N!M!}-\sum_{y=0}^{P-1}{\frac{(M-Q+1+y)!}{(M-Q+1)!y!}\frac{(N+Q-1-y)!}{(Q-1)!(N-y)!}} 
x
(N,M,P,Q)
x
x
H
(0,M-Q)
(N-P,M-Q)
(x,y)
H
U(x,y)
(0,M)
(x,y)
H
(x,y)
L(x,y)
(x,y)
(N,0)
(0,M)
(N,0)
H
(x,y
U(x,y)L(x,y)
x
0
N-P
R(i,j)
i \times j
L(x,y)=R(N-x,M-Q)
U(x,y)
H
(x,y)
(x,y+1)
U(x,y)
R(x,Q-1)
R(i,j)=\frac{(i+j)!}{i!j!}
{N-A+B \choose B} {M-B+A \choose A} + \sum_{r=0}^{N-A-1} {B+r \choose r}  {N-r+M-B-1 \choose N-r}
A=P
B=Q
O(n \log n)
