 {\partial \over \partial \mathbf a} \arctan(\mathbf{|a \times b| \over a^T b}) 
 \mathbf {a,b} \in \mathbf R^3 
 \mathbf a = \mathbf {x_{i-1} - x_i} 
\mathbf{b=x_i - x_{i+1}}
\arctan \theta \approx \theta
 {{{\partial \over \partial \mathbf a} (\mathbf{|a \times b|})}\over\mathbf a^T \mathbf b} + {{\partial \over \partial \mathbf a} (\mathbf a^T \mathbf b)^{-1} (|\mathbf a \times \mathbf b|)} 
 {\partial \over \partial \mathbf a} \mathbf{| a \times b |} = {\partial \over \partial \mathbf a}((\mathbf{a \times b})^T(\mathbf{a \times b}))^{1/2}\\ ={1 \over 2 \mathbf {|a \times b|}} (({\partial \over \partial \mathbf a}(\mathbf{a \times b})^T)(\mathbf{a \times b})+ (\mathbf{a \times b})^T({\partial \over \partial \mathbf a}(\mathbf{a \times b}))) 
 {\partial \mathbf a^T \over \partial \mathbf a} = \mathbf I^{3\times3}
\mathbf b^T 
