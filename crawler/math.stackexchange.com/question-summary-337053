p
10^6
p
p|\sum_{n=1}^{p-1} n!
 \qquad \qquad \displaystyle E= \Tiny \left[ \begin{array} {rrrrr}  1 & . & . & . & . & . \\  1 & 0 & . & . & . & . \\  1 & 1 & 0 & . & . & . \\  1 & 4 & 1 & 0 & . & . \\  1 & 11 & 11 & 1 & 0 & . \\  1 & 26 & 66 & 26 & 1 & 0  \end{array} \right] 
E \cdot V(1) = F 
V(1)
F
p
p
p=13
 \qquad \qquad V(1)^T_{p+1} ~ \cdot E_{p+1,p+1} \pmod p = \\\qquad \qquad  \left[ \begin{array} {rrrrrrrrrrrrr}  1 & 2 & 3 & 11 & 6 & 12 & 5 & 12 & 6 & 11 & 3 & 2 & 1 & 0  \end{array} \right]
p=2q+1
0!
 S_p \equiv \sum_{k=0}^{p-1} k! \equiv 2 \sum _{k=0}^{q-1} k^k (k+1)^{p-1-k} + (q \cdot -q)^q  \pmod p 
p<N
O(N^2)
p
N
p
p!
(p-1)!
p
(p-1)!
10^5
10^6
p
n
n
(n-1)!
n
(p-1)!\equiv -1 \mod{p}
(p-2)!\equiv 1 \mod{p}
a
F_p
\dfrac{1}{a}
\dfrac{1}{a} + \dfrac{1}{b} = \dfrac{a+b}{ab}
F_p
(p-3)! \equiv -\dfrac{1}{2}\mod{p}
(p-4)! \equiv -\dfrac{1}{2}\cdot\left(-\dfrac{1}{3}\right)\mod{p}
\cdots
1! \equiv (-1)^{p-3}\dfrac{1}{(p-2)!} \mod{p}
1!+2!+\cdots(p-3)! \equiv -\sum_{k=0}^{p-2}(-1)^k\dfrac{1}{k!}\mod{p}
\dfrac{p}{q}
q = m!
\exp(-1)
\dfrac{p}{q}
\dfrac{p}{q} = \sum_{j=0}^m (-1)^j\dfrac{1}{j!}
-\sum_{k=0}^{p-2}(-1)^k\dfrac{1}{k!} \equiv - \mathrm{floor}\left[\dfrac{(p-2)!}{\exp(1)}\right]\mod{p}
p
\exp(1)
