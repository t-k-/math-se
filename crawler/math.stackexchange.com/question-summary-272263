k\geq p
M=\lfloor \sqrt{k}\rfloor
O(\sqrt{p})
O(p)
