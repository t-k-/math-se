d
d
y
v
\theta
d
v
\phi
\phi
d
v
 \phi = \arccos \left( \frac{d\cdot v}{\Vert d \Vert \Vert v \Vert} \right) 
\theta
 d \times v 
y
 d \times v 
\theta
\psi
\psi+\pi
\theta
y
d\times v
\psi = \arccos \left( \frac{(d \times v)\cdot y}{\Vert d \times v \Vert \Vert y \Vert} \right) 
 \theta=\begin{cases} 0, & \mbox{if }y\cdot\left(d\times v\right)=\Vert y\Vert\,\Vert d\times v\Vert,\\ \psi, & \mbox{if }\left(y\times\left(d\times v\right)\right)\cdot d\geq 0,\\ \psi+\pi, & \mbox{if }\left(y\times\left(d\times v\right)\right)\cdot d<0. \end{cases} 
\theta
\phi
