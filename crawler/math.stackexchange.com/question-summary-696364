1\le n\le1000
10^9
m
m
m
1
10^9
O(q\log q)
k=2^m(2n+1)
2
2^m
2n+1
n=2q
n=2q+1
a[x],b[x+1]\xrightarrow{*}c[y],d[y+1]
x>y
a[1],b[2]
[2^m(2n+1)] \rightarrow 2[2^{m-1}(2n+1)]\rightarrow2[2^{m-2}(2n+1)],[2^{m-1}(2n+1)]
\rightarrow4[2^{m-2}(2n+1)]
[2^m(2n+1)] \xrightarrow{2^{m}-1} 2^m[2n+1]\tag1
[2n+1]\rightarrow[n],[n+1]
[2q],[2q+1]\rightarrow[2q],[q+1],[q]\rightarrow 3[q],[q+1]
\implies a[2q],b[2q+1]\xrightarrow{a+b} (2a+b)[q],b[q+1]\tag2
[2q+1],[2q+2]\rightarrow[2q+1],2[q+1]\rightarrow [q],3[q+1]
\implies a[2q+1],b[2q+2]\xrightarrow{a+b} a[q],(a+2b)[q+1]\tag3
