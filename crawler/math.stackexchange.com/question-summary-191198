F = ax^2 + bxy + cy^2
\mathbb{Z}
D = b^2 - 4ac
F
m
m = ax^2 + bxy + cy^2
\mathbb{Z}^2
m
F
m = ax^2 + bxy + cy^2
(s, t)
(s, t) = 1
m
F
x
y
x,y
(1)
(a,b,c)
\tag 1 f(x,y)=ax^2 + 2bxy + cy^2
M
(a,b,c)
x,y
M=f(x,y)
\left( {a{m^2} + 2bmn + c{n^2}} \right)\left( {a{\nu ^2} - 2b\nu \mu  + c{\mu ^2}} \right) = 
{\left( {\mu \left( {mb + nc} \right) - \nu \left( {ma + nb} \right)} \right)^2} - \left( {{b^2} - ac} \right){\left( {m\mu  + n\nu } \right)^2}
M\left( {a{\nu ^2} - 2b\nu \mu  + c{\mu ^2}} \right) = {\left( {\mu \left( {mb + nc} \right) - \nu \left( {ma + nb} \right)} \right)^2} - \left( {{b^2} - ac} \right)
{b^2} - ac \equiv {\left( {\mu \left( {mb + nc} \right) - \nu \left( {ma + nb} \right)} \right)^2}\bmod M
f(x, y) = ax^2 + bxy + cy^2
m = ax^2 + bxy + cy^2
(p, r)
(p, r) = 1
s, q
ps - qr = 1
f(pu + qv, ru + sv) = m'u^2 + luv + kv^2
u, v
m' = ap^2 + bpr + cr^2
l = 2apq + b(ps + qr) + 2crs
k = aq^2 + bqs + cs^2
m' = m
D = l^2 - 4mk
D \equiv l^2
4m
