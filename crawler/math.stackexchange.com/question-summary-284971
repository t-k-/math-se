\prod_{k=1}^{n}\left(1+2\cos\frac{2\pi 3^k}{3^n+1} \right)=1
\cos
0
2\pi
1
\cos(nx)=2\cos(x)\cos((n-1)x)-\cos((n-2)x)
S_n = \sum_{k=0}^n 3^k = \frac{3^{n+1}-1}{2}
3^{n}- S_{n-1} = 3^{n} - \frac{3^{n}-1}{2} = \frac{3^{n}+1}{2} = S_{n-1}+1. 
n \geq 0
 \begin{eqnarray} \prod_{k=0}^{n}\left(z^{3^k}+1+z^{-3^k}\right) &=& \left(z^{3^{n}}+1+z^{-3^{n}}\right)\prod_{k=0}^{n-1}\left(z^{3^k}+1+z^{-3^k}\right) \\ &=& \left(z^{3^{n}}+1+z^{-3^{n}}\right) \left(\sum_{k=-S_{n-1}}^{S_{n-1}} z^k\right) \\ &=&\sum_{k=S_{n-1}+1}^{S_n}z^k + \sum_{k=-S_{n-1}}^{S_{n-1}}z^k+\sum_{k=-S_n}^{-S_{n-1}-1} z^k \\ &=& \sum_{k=-S_n}^{S_n} z^k \end{eqnarray} 
z = \exp\left(\frac{\pi \, i}{3^n + 1}\right)
z^{3^n+1}=-1
\begin{eqnarray} \prod_{k=0}^n\left(1 + 2 \cos \left(\frac{2 \pi \,3^k}{3^n+1}\right)\right) &=& \sum_{k=-S_n}^{S_n}z^{2k} = \frac{z^{2S_n+1}-z^{-2S_n-1}}{z-z^{-1}} = \frac{z^{3^{n+1}}-z^{-3^{n+1}}}{z-z^{-1}} \\ &=& \frac{z^{3(3^n+1)-3} - z^{-3(3^n+1)+3}}{z-z^{-1}} = \frac{z^3-z^{-3}}{z-z^{-1}} = z^2 + 1 + z^{-2} \\ &=& 1 + 2\cos\left(\frac{2\pi}{3^n+1}\right) \end{eqnarray}
