p-1
\gcd(p,d)=1
2p-1
\gcd(p,d)>1
p
x^2 \equiv y^2-d \pmod p
2p-1
(x-y)(x+y)\equiv d\pmod{p}
d
p
(a,a)
(a,-a)
a
0
p-1
p
p
a=0
2(p-1)+1=2p-1
d
p
x-y = a
a
1
p-1
y-x
0
a
b
ab\equiv -d\pmod{p}
x^2-y^2\equiv d\pmod{p}
x+y\equiv b\pmod{p}
p
2
p
x-y\equiv a\pmod p
x+y \equiv b\pmod{p}
(x,y)
p
a
p-1
p=3
p \ge 3
