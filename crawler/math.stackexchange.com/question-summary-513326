\text{tr} (W^TMW)-\text{tr}(NW)
W^TW=I
M
N
\mathbf{w}=\mathrm{vec}(W)
\mathbf{q}=\frac{1}{2}\mathbf{M}^{-1}\mathrm{vec}(N^T)
\mathbf{M}=I\otimes M
M
k
k
N
W
\|\mathbf{w}-\mathbf{q}\|_{\mathbf{M}}
\mathrm{tr}(W^TMW)-\mathrm{tr}(NW)
\mathbf{q}^T\mathbf{M}\mathbf{q}
W
W^TW=1
\|\mathbf{w}\|_2=1
 \mathrm{tr}(W^TMW) = \mathbf{w}^T\mathbf{M}\mathbf{w}, \qquad \mathrm{tr}(NW) = 2\mathbf{q}^T\mathbf{M}\mathbf{w}. 
 \|\mathbf{w}-\mathbf{q}\|_{\mathbf{M}}=(\mathbf{w}-\mathbf{q})^T\mathbf{M}(\mathbf{w}-\mathbf{q}) =\mathrm{tr}(W^TMW)-\mathrm{tr}(NW)+\mathbf{q}^T\mathbf{M}\mathbf{q}, 
\mathbf{w}
 \|\mathbf{w}-\mathbf{q}\|_{\mathbf{M}}=\min_{\tilde{\mathbf{w}}}\|\tilde{\mathbf{w}}-\mathbf{q}\|_{\mathbf{M}}\quad\text{subject to}\quad\|\mathbf{w}\|_2=1. 
