f(r)=\int_{-\infty}^{\infty}dz\int_0^{2\pi}d\phi\frac{1}{\sqrt{z^2+r^2+R^2-2rR\cos\phi}}
2/r
d\phi
dz
1/z
 \begin{align} f'(r) &=\int_{-\infty}^{\infty}\mathrm dz\int_0^{2\pi}\mathrm d\phi\frac{R\cos\phi-r}{\sqrt{z^2+r^2+R^2-2rR\cos\phi}^3} \\ &= 2\int_0^{2\pi}\mathrm d\phi\frac{R\cos\phi-r}{r^2+R^2-2rR\cos\phi} \\ &= 4\int_0^\pi\mathrm d\phi\frac{R\cos\phi-r}{r^2+R^2-2rR\cos\phi} \\ &= 4\int_0^{\infty}\frac{R(1-t^2)/(1+t^2)-r}{r^2+R^2-2rR(1-t^2)/(1+t^2)}\frac{2\mathrm dt}{1+t^2} \\ &= 4\int_{-\infty}^{\infty}\frac{R(1-t^2)-r(1+t^2)}{(r^2+R^2)(1+t^2)-2rR(1-t^2)}\frac{\mathrm dt}{1+t^2} \\ &= -4\int_{-\infty}^{\infty}\frac{r-R+(r+R)t^2}{(r-R)^2+(r+R)^2t^2}\frac{\mathrm dt}{1+t^2} \\ &= -\frac4{r+R} \int_{-\infty}^{\infty}\frac{\lambda+t^2}{\lambda^2+t^2}\frac{\mathrm dt}{1+t^2} \end{align} 
\lambda=(r-R)/(r+R)
t^{-2}
\pm\mathrm i
\pm\lambda\mathrm i
\mathrm i
\frac{\lambda-1}{\lambda^2-1}\frac1{2\mathrm i}=\frac1{\lambda+1}\frac1{2\mathrm i}=\frac{r+R}{4r\mathrm i}\;,
\lambda\mathrm i
 \frac{\lambda-\lambda^2}{2\lambda\mathrm i}\frac1{1-\lambda^2}=\frac1{2\mathrm i}\frac1{1+\lambda}=\frac{r+R}{4r\mathrm i}\;. 
R\gt r
\lambda\lt0
-\lambda\mathrm i
R\lt r
\lambda\gt0
 2\pi\mathrm i\frac{-4}{r+R}2\frac{r+R}{4r\mathrm i}=-\frac{4\pi}r\;. 
