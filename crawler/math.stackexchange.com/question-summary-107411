\int_{a}^{b}f(x)dx
[a,b]
n
f
f
f
[x_{i-1},x_{i}]
\frac{x_{i}-x_{i-1}}{3}\left [ \frac{f(x_{i-1})}{2}+2f\left(\frac{x_{i-1}+x_{i}}{2}\right)+\frac{f(x_{i})}{2} \right ].
\int_{a}^{b}f(x)dx \approx \frac{2}{3}\text{MID}(n)+\frac{1}{3}\text{TRAP}(n)
h = (x_{i} - x_{i-1})/2
p(x) = ax^2 + bx + c
[-h,h]
p(x)
p(x)
f
\int_{-h}^{h} p(x),
ax^2+bx+c
x_{i-1}
\dfrac{x_{i-1}+x_i}{2}
x_i
[x_{i-1},x_i]
\begin{pmatrix}1&x_{i-1}&x_{i-1}^2\\1&\frac{x_{i-1}+x_i}{2}&\left(\frac{x_{i-1}+x_i}{2}\right)^2\\1&x_i&x_i^2\end{pmatrix}\begin{pmatrix}c\\b\\a\end{pmatrix}=\begin{pmatrix}f(x_{i-1})\\f\left(\frac{x_{i-1}+x_i}{2}\right)\\f(x_i)\end{pmatrix}
\displaystyle p(x)=\frac{2\left(f\left(x_{i-1}\right)-2f\left(\frac{x_{i-1}+x_i}{2}\right)+f\left(x_i\right)\right)}{\left(x_i-x_{i-1}\right)^2}\left(x-\frac{x_{i-1}+x_i}{2}\right)^2+\frac{f\left(x_i\right)-f\left(x_{i-1}\right)}{x_i-x_{i-1}}\left(x-\frac{x_{i-1}+x_i}{2}\right)+f\left(\frac{x_{i-1}+x_i}{2}\right)
\int_{x_{i-1}}^{x_i}p(u)\;\mathrm du
\begin{align*} \text{trap}&=\int_{x_{i-1}}^{x_i}\left(f\left(x_{i-1}\right)+\frac{f\left(x_i\right)-f\left(x_{i-1}\right)}{x_i-x_{i-1}}\left(u-x_{i-1}\right)\right)\;\mathrm du\\ &=\frac{x_i-x_{i-1}}{2}\left(f(x_{i-1})+f(x_i)\right)\\ \text{mid}&=\int_{x_{i-1}}^{x_i}f\left(\frac{x_{i-1}+x_i}{2}\right)\;\mathrm du\\ &=(x_i-x_{i-1})f\left(\frac{x_{i-1}+x_i}{2}\right) \end{align*}
p
q
\frac{x_i-x_{i-1}}{3}\left(\frac{f(x_{i-1})}{2}+2f\left(\frac{x_{i-1}+x_i}{2}\right)+\frac{f(x_i)}{2}\right)=p\;\text{trap}+q\;\text{mid}
