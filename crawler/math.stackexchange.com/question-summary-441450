45^\circ
\triangle P_1P_2P_4
\begin{align} |P_1P_2|^2 + |P_2 P_4|^2 &= |P_1 P_4|^2 \\[6pt] |P_1P_2|^2 + g^2 &= ( r - g )^2 \\[6pt] |P_1P_2|^2 &= ( r - g )^2 - g^2 = r ( r - 2 g )  \end{align}
|P_2P_4|
x
P_4
|P_1P_2|
y
P_4 = \left( \; g, \; \sqrt{r(r-2g)} \; \right)
45^\circ
P_2
P_3
y
P_4
y
P_4
\frac{|P_1P_3|}{|P_1P_4|} = \frac{r}{r-g}
\begin{align} P_2 &= \left( \; 0, \; \sqrt{r(r-2g)} \; \right) &\text{(same $y$ as $P_4$, but on $y$-axis)} \\[6pt] P_3 &= \left( \; \frac{gr}{r-g}, \; \frac{r\;\sqrt{r(r-2g)}}{r-g} \; \right) &\text{(scaling-up $P_4$ by $\frac{|P_1P_3|}{|P_1P_4|} = \frac{r}{r-g}$)} \end{align}
P_2 = (0,0)
P_3 = (2g,0)
P_4=(g,0)
g=0
P_2=P_3=P_4=(0,r)
(x,y)^R=(-y,x)
r
p_1
p_2
 \frac{p_1+p_2}{2}\pm(p_1-p_2)^R\sqrt{\frac{r^2}{|p_1-p_2|^2}-\frac14}\tag{1} 
g
(2)
r
(1)
 \frac{\sqrt{2r^2-(r-g)^2}-(r-g)}{\sqrt{2r^2-(r-g)^2}+(r-g)}(r-g)\tag{2} 
p_1=(8,1)
p_2=(0,7)
r=13
(1)
(11.2,13.6)
(-3.2,-5.6)
 \begin{align} \frac{p_1+p_2}{2}&=(4,4)\\ (p_1-p_2)^R&=(8,-6)^R\\ &=(6,8)\\ |p_1-p_2|&=10 \end{align} 
 (4,4)\pm(6,8)\sqrt{\frac{13^2}{10^2}-\frac14} =(4,4)\pm(7.2,9.6) 
p_1 = (x_1, y_1)
p_2 = (x_2, y_2)
q = ((x_1+x_2)/2, (y_1+y_2)/2)
R = \sqrt{(x_2-x_1)^2+(y_2-y_1)^2}
p_1
p_2
q
d = (-dy, dx)
dx = x_2-x_1
dy = y_2-y_1
q + t d
t
r
p_1
p_2
|q+td-p_1| = r
|q+td-p_1|^2 = r^2
\begin{align} r^2  &= ((x_1+x_2)/2+t(-dy)-x_1)^2 +((y_1+y_2)/2+t(dx)-y_1)^2\\ &= ((x_2-x_1)/2+t(-dy))^2 +((y_2-y_1)/2+t(dx))^2\\ &= (dx/2-t\ dy)^2 +(dy/2+t\ dx)^2\\ &= dx^2/4-dx\ t\ dy+t^2\ dy^2 +dy^2/4+dy\ t\ dx+t^2\ dx^2\\ &= t^2\ (dx^2+dy^2) + (dx^2+dy^2)/4\\ &= (dx^2+dy^2)(t^2+1/4)\\ &= R^2(t^2+1/4)\\ \text{so}\\ t^2 &= \left(\dfrac{r}{R}\right)^2-1/4 \end{align} 
t
p_1
p_2
q+td = ((x_1+x_2)/2-t\ dy), (y_1+y_2)/2+t\ dx) 
