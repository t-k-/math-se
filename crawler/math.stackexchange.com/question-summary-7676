(ab,p)=1
p>2
(x,y)
ax^2+by^2\equiv 1\pmod{p}
p-\left(\frac{-ab}{p}\right)
(ab,p)=1
(a,p)=(b,p)=1
\left(\frac{-ab}{p}\right)=\left(\frac{-1}{p}\right)\left(\frac{a}{p}\right)\left(\frac{b}{p}\right)
\left(\frac{a}{p}\right)=\left(\frac{b}{p}\right)=1
-1
\left(\frac{ab}{p}\right)=1
p-(-1)^{(p-1)/2}
\left(\frac{a}{p}\right)=1
\left(\frac{b}{p}\right)=-1
p+(-1)^{(p-1)/2}
a
b
p
c^2\equiv a\pmod{p}
d^2\equiv b\pmod{p}
c,d
(cx)^2+(dy)^2\equiv 1\pmod{p}
0
\mathbb{P}^1
p+1
\mathbb{P}^1
a = b = 1
x^2 + y^2 = 1
(1, 0)
x = \frac{1 - t^2}{1 + t^2}, y = \frac{2t}{1 + t^2}
t
t^2 \not \equiv -1 \bmod p
(x, y)
(x, y)
(1, 0)
(1, 0)
t
\infty
p+1
p \equiv 3 \bmod 4
t
p-1
p \equiv 1 \bmod 4
t
-1
a, b
a
b
 ax^2+by^2-1=(au^2+bv^2)t^2+2(ux_0+vy_0)t=0\ \Rightarrow\ t=-2\frac{ux_0+vy_0}{au^2+bv^2}\ (*) 
