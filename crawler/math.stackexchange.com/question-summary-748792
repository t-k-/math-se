p
p \equiv  1 \mod 4
r
p
-r
p
-r^{\phi(p)} \equiv 1 \mod p
-r
p
\phi(p)
\phi(p)
p=4k+1
r
p
r^{2k}\equiv -1\pmod{p}
(-r)^{2k}\equiv -1\pmod{p}
r
-r
r
p
-r
p
(-r)^{2k+1}\equiv (-1)(-r)\equiv r\pmod{p}.
r^{\frac{p+1}{2}} \equiv r^{\frac{p-1}{2}}r \equiv -r \pmod{p}
