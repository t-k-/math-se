 \sum_i||Ax_i-b_i||_2^2 
A
x
x_i
b_i
A
C
 \sum_i(Ax_i-b_i)^TC^{-1}(Ax_i-b_i) 
\begin{align*}\sum_i \|Ax_i-b_i\|^2 &= \sum_i \sum_j (Ax_i-b_i)_j^2\\ &= \sum_i \sum_j \left(\sum_k A_{jk}x_{ki} - b_{ji}\right)^2\\ &= \sum_i \sum_j \left(\sum_k x^T_{ik} A^T_{kj} - b^T_{ij}\right)^2\\ &= \sum_i \sum_j (x^T A^T_j - b^T_j)_i^2\\ &= \sum_j \|x^T A^T_j - b_j^T\|^2. \end{align*}
x^T
x_i
A_j^T
j
A
b_1^T
b_i
C^{-1}
C
\sum_i(Ax_i-b_i)^TC^{-1}(Ax_i-b_i)
\frac{\rm d}{\rm{d} A}((Ax-b)^TC^{-1}(Ax-b))=-2xb^T{C^{-1}}^T+{C^{-1}}^TAxx^T+C^{-1}Axx^T
\sum_iAx_ix_i^T=\sum_iCx_ib_i^TC^{-1}
\sum_ix_ix_i^TA^T=\sum_iC^{-1}b_ix_i^TC
A
a_j
j
A^T
j
A
d_j
j
\sum_iC^{-1}b_ix_i^TC
a_j
\sum_ix_ix_i^Ta_j=d_j
L^1
