 \theta = \tan^{-1}\left(\frac{W}{H}\right) 
W<H
 k = \begin{cases}  \cos\theta+\frac{W}{H}\sin\theta & W\geq H\\ \cos\theta+\frac{H}{W}\sin\theta & W < H \end{cases} 
k = \cos\theta + \max\left\{\frac{W}{H},\frac{H}{W}\right\}\sin\theta
