N
r
s
\mathbb{Z}_N
\gcd{(N, r)}=1
\gcd{(N, s)}=1
r
s
\mathbb{Z}_N
g=\gcd{(N, r-s)}
u=N/g
v=(r-s)/g
N=ug
r-s=vg
\gcd{(u, v)}=1
r^{-1}
s^{-1}
r
s
\mathbb{Z}_N
r-s\equiv 0 ~mod~ g
r \equiv s ~mod~ g
r^{-1} \equiv s^{-1} ~mod~ g
r^{-1}-s^{-1}\equiv 0 ~mod~ g
r^{-1}-s^{-1}=v'g
h
N
h>g
h|r^{-1}-s^{-1}
r^{-1}\equiv s^{-1}\pmod h
r-s\equiv0\pmod h
g
h
\gcd(r,h)|\gcd(r,N)=1
\gcd(r,h)=1
u
v'
r', s'
rr'\equiv ss'\equiv 1\mod{N}
\gcd(N, r-s) = \gcd(N, r'-s')
r'-s'\equiv -(r-s)r's' \mod{N}
\gcd(-r's',N)=1
\square
\gcd(N, r'-s')=\gcd(N, (-r's')(r-s))=\gcd(N, r-s)
