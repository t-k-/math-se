p
n
s
c=\sum_{k=0}^{\lfloor(p-n)/s\rfloor}(-1)^k\binom{n}k\binom{p-sk-1}{n-1}\;.
n
m
1, 5, 3, 5, 6
1
3
p
n-m
5+5+6=16
n=5, m=2
c(n,p,s)
p
n
s
r
r
k
n-k
c(n-k, p-rn, s-r)
n
n-m
p
r
n-m
k
r
n-m
m
r
m-i
n
 \binom{n}{i} \binom{n-i}{k+m-i} (r-1)^i c(n-m-k,p-r(n-m),s-r) 
i
r
k+m-i
r
\binom{n}{i} \binom{n-i}{k+m-i}
i
r
(r-1)^i
n-m-k
r
p-rk
c(.)
i
r
k
 \sum_{r=1}^{s} \sum_{k=1}^{n-m} \left[ c(n-m-k,p-r(n-m),s-r) \sum_{i=0}^{m} \binom{n}{i} \binom{n-i}{k+m-i} (r-1)^i \right] 
