a+b\sqrt{q}
(a+b\sqrt{q})^n=1\pmod{m}
(a_1+b_1\sqrt{q})(a_2+b_2\sqrt{q})=c+d\sqrt{q}\pmod{m}
c=(a_1a_2+b_1b_2q)\pmod{m}
d=(a_1b_2+b_1a_2)\pmod{m}
m
O((\ln m)^e)
e
m
Z/m(\sqrt{q})
n
