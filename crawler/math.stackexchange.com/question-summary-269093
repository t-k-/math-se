n
 S =\sum\limits_{x=0}^{n} \frac{n!}{(n-x)!\,n^x}\left(1-\frac{x(x-1)}{n(n-1)}\right) 
S = \mathbb{E}(X) \leq \text{mean time to find a duplicate} \sim \sqrt{\frac{\pi}{2} n}
\sum_{x=0}^{n} \frac{n!}{(n-x)!\,n^x} = \left(\frac{e}{n} \right)^n \Gamma(n+1,n) \sim \left(\frac{e}{n} \right)^n  \frac{n!}{2} \sim  \sqrt{\frac{\pi}{2} n}. 
N_n
n
\lim\limits_{n\to\infty}S_n/\sqrt{n}=\sqrt{\pi/2}
 S_n=\frac{n-2}{n-1}n!\left(\frac{\mathrm e}n\right)^n\mathbb P(N_n\leqslant n)+\frac2{n-1}. 
k\ll n
n
k=1
\simeq \sqrt{n}
n
\sqrt{n} \ll n
k \lesssim \sqrt{n} \ll n
\frac{n!}{(n-k)!} \frac{1}{n^k} = \frac{n}{n} \frac{n-1}{n} \cdots \frac{n-k+1}{n} = \prod_{j=1}^{k-1} \left(1- \frac{j}{n}\right)
\log \left[\frac{n!}{(n-k)!} \frac{1}{n^k}\right] = \log\left[ 1 -\sum_{j=1}^{k-1}\frac{j}{n} + \mathcal{O}\left(\frac{1}{n^2}\right)\right] =  - \frac{k(k-1)}{2n} + \mathcal{O}\left(n^{-2}\right).
S_n =\sum_{k=1}^n k g_n(k) \sim \sum_{k=1}^n \frac{k (k-1)\overbrace{(k+n)}^{\approx n}}{\underbrace{n(n-1)}_{\approx n^2}}  e^{-k(k-1)/2n} \sim -2 \partial_{\alpha}\sum_{k=1}^n e^{-\alpha k(k-1)/2n}\bigg|_{\alpha=1}.
k
k+1
  \sum_{k=1}^n e^{-\alpha k(k-1)/2n}  \sim \int_0^n e^{-\alpha x^2/2n}   \sim \int_0^\infty e^{-\alpha x^2/2n} = \sqrt{\frac{\pi n}{2 \alpha}}.
S_n \sim -2 \partial_{\alpha} \sqrt{\frac{\pi n}{2 \alpha}}\,\bigg|_{\alpha=1}=  \sqrt{\frac{\pi n}{2}}.
\mathcal{O}(k^3/n^2) = \mathcal{O}(n^{-1/2})
k\leq \sqrt{n}
 \log \left[\frac{n!}{(n-k)!} \frac{1}{n^k}\right]
k+n = n [1+ \mathcal{O}(n^{-1/2})]
n(n-1) = n^2[1+\mathcal{O}(n^{-1})]
\partial_x e^{- x(x-1)/2n}
\sqrt{n}
n^{-1/2}
 \sum_{k=1}^n e^{-\alpha k(k-1)/2n}  \sim \int_1^{n-1} e^{-\alpha x(x-1)/2n} 
x(x-1)
x^2
n^{-1/2}
\propto e^{-n}
S_n = \sqrt{\pi n/2} + \mathcal{O}(1)
S = \sqrt{\frac{\pi n}{2}} + \frac{2}{3} + O(n^{-1/2+4\epsilon}).
x \leq n^{1/2+\epsilon}
e^x = 1 + x + O(x^2)
\frac{n!}{(n-x)!n^x} = e^{-x^2/2n} \left(1 + \frac{x}{2n} - \frac{x^3}{6n^2} + O(n^{-1+4\epsilon})\right),
\displaystyle \frac{n!}{(n-x)!n^x}
x
x > n^{1/2+\epsilon}
\displaystyle \frac{n!}{(n-x)!n^x} = O(e^{-x^2/2n}) = O(e^{-n^{2\epsilon}/2})
\sum_{x > n^{1/2} + \epsilon} \frac{n!}{(n-x)!n^x} = O(ne^{-n^{2\epsilon}/2}),
\displaystyle \sum_{x =0}^n \frac{n!}{(n-x)!n^x} \frac{x(x-1)}{n(n-1)},
x > n^{1/2+\epsilon}
x \leq n^{1/2+\epsilon}
\frac{n!}{(n-x)!n^x} \frac{x(x-1)}{n(n-1)} = e^{-x^2/2n} O(n^{-1+\epsilon}).
\sum_{x=0}^n \frac{n!}{(n-x)!n^x} \frac{x(x-1)}{n(n-1)} = O(n^{-1/2+\epsilon}).
S = \sqrt{\frac{\pi n}{2}} + \frac{2}{3} + O(n^{-1/2+4\epsilon}).
