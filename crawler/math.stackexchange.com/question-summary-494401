n=2pq+1
p
q
q>2p
a
a^{n-1} \equiv 1 \pmod n
\gcd(a^{2p}-1,n)=1
n
n=hq^k+1
h=2p
p
q
k=1
a^{n-1} = a^{2pq} \equiv 1 \pmod{n}
\gcd(a^{2p}-1,n) = 1
r
n
a^{2p} \not\equiv 1 \pmod{r}
a^{2pq} \equiv 1 \pmod{r}
a
r
q
r \equiv 1 \pmod{q}
r \geqslant q+1
(q+1)^2 > n
n
