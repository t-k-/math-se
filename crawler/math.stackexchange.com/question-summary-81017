u := \frac{1}{d} (x_2 - x_1, y_2 - y_1, z_2 - z_1)^T
d
u
e_x =  (1, 0, 0)
u
u
e_x
v := u \times e_x
w := v \times u
R = (u, v, w)
R
x
(1,0,0)
x
 \begin{eqnarray} \pmatrix{\cos\phi&-\sin\phi&0\\\sin\phi&\cos\phi&0\\0&0&1}\pmatrix{\cos\theta&0&\sin\theta\\0&1&0\\-\sin\theta&0&\cos\theta}\pmatrix{1\\0\\0} &=& \pmatrix{\cos\phi&-\sin\phi&0\\\sin\phi&\cos\phi&0\\0&0&1}\pmatrix{\cos\theta\\0\\-\sin\theta} \\ &=&\pmatrix{\cos\phi\cos\theta\\\sin\phi\cos\theta\\-\sin\theta} \;. \end{eqnarray} 
(x,y,z)=(x_2,y_2,z_2)-(x_1,y_1,z_1)
\theta=-\arcsin\frac zr
\phi=\arctan\frac yx\;,
r=\sqrt{x^2+y^2+z^2}
0
x=0
y
z
x
\phi
180^{\circ} - \phi
