2
p_1, p_2, \ldots, p_n
\color{blue}{(p_1-1,}
p_1-1<p_0+1
\color{blue}{p_0+1), (p_1-1,}
p_2-1<p_1+1
\color{blue}{p_1+1),(p_2-1,}
\color{blue}{p_n+1)}
(p_i-1, p_i+1)
i
r_i
0
|r_i| \geq 1
r_i - 1
r_{i-1}
r_{i-1} -1
r_k -1
r_{k-1}
r_i + 1
r_{i+1} + 1
r_j + 1
r_{j+1}
r_k-1
r_j +1
r_i
R
R_+
R_-
R_+,R_-
x \ge 0
y \le 0
n
O(n \log n)
x,y
x,y
x,y
x_{can} \ge 0
y_{can} \le 0
R_+ = [x_1,x_2,\ldots,x_p]
R_- = [y_1,y_2,\ldots,y_q]
p=0
q=0
0 \in R
\{x_{can} := 1 \;; y_{can} := -1\}
\{x_{can} := \max(0,y_1+1) \;; y_{can} := \min(0,x_1-1)\}
i := 1
j := 1
(i \le p
x_{can} \gt x_i - 1)
\{x_{can} := x_i + 1 \;;\; i := i+1\}
(j \le q
y_{can} \lt y_j + 1)
\{y_{can} := y_j - 1 \;;\; j := j+1\}
(x_{can} + y_{can} \le 0)
x_{can}
y_{can}
