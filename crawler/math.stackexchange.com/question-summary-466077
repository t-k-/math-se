ax^2+by^2=cz^2
(a,b,c)=(1,1,1)
(1,1,n^2+1)
ax^2+by^2+cz^2=0\tag{1}
(p^2-nq^2)^2+n(2pq)^2 = (p^2+nq^2)^2\tag{2}
(1)
x, y, z
x_i = x(-a p^2 + b q^2 + c r^2) - 2p(b q y + c r z)
y_i = y(a p^2 - b q^2 + c r^2) - 2q(a p x + c r z)
z_i = z(a p^2 + b q^2 - c r^2) - 2r(a p x + b q y)
p,q,r
aX^2+bXY+cY^2=jZ^2
X=(2j(b+2c)^2-(b^2+4c(j-a))(j\pm\sqrt{j(a+b+c)}))s^2+2(b+2c)(\sqrt{j(a+b+c)}\mp{j})sp+(j\mp \sqrt{j(a+b+c)})p^2
Y=(2j(2j-b-2a)(b+2c)-(b^2+4c(j-a))(j\pm\sqrt{j(a+b+c)}))s^2+ +2((2j-2a-b)\sqrt{j(a+b+c)}\mp{j(b+2c)})sp+(j\mp\sqrt{j(a+b+c)})p^2
Z=(2j(b+2c)^2-(b^2+4c(j-a))(a+b+c\pm\sqrt{j(a+b+c)}))s^2+ +2(b+2c) ( \sqrt{j(a+b+c)} \mp{j})sp + ( a + b + c \mp \sqrt{j(a+b+c)})p^2 
\sqrt{b^2+4c(j-a)}
X=((2j-b-2c)(8ac+2b(2j-b))-(b^2+4a(j-c))(b+2c\mp\sqrt{b^2+4c(j-a)}))s^2++2(4ac+b(2j-b)\pm{(2j-b-2c)}\sqrt{b^2+4c(j-a)})sp+(b+2c\pm\sqrt{b^2+4c(j-a)})p^2
Y=((b+2a)(8ac+2b(2j-b))-(b^2+4a(j-c))(2j-b-2a\mp\sqrt{b^2+4c(j-a)}))s^2++2(4ac+b(2j-b)\pm{(b+2a)}\sqrt{b^2+4c(j-a)})sp+(2j-b-2a\pm\sqrt{b^2+4c(j-a)})p^2
Z=((b+2a)(8ac+2b(2j-b))-(b^2+4a(j-c))(b+2c\mp\sqrt{b^2+4c(j-a)}))s^2++2(4ac+b(2j-b)\pm {(b+2a)}\sqrt{b^2+4c(j-a)})sp+(b+2c\pm\sqrt{b^2+4c(j-a)})p^2
\sqrt{b^2+4a(j-c)}
X=(2j^2(b+2a)-j(a+b+c)(2j-2c-b\pm\sqrt{b^2+4a(j-c)}))p^2+ +2j(\sqrt{b^2+4a(j-c)}\mp{(b+2a)})ps+(2j-2c-b\mp\sqrt{b^2+4a(j-c)})s^2
Y=(2j^2(b+2a)-j(a+b+c)(b+2a\pm\sqrt{b^2+4a(j-c)}))p^2+ +2j(\sqrt{b^2+4a(j-c)}\mp{(b+2a)})ps+(b+2a\mp\sqrt{b^2+4a(j-c)})s^2
Z=j(a+b+c)(b+2a\mp\sqrt{b^2+4a(j-c)})p^2+ +2((a+b+c)\sqrt{b^2+4a(j-c)}\mp{j(b+2a)})ps+ (b+2a\mp\sqrt{b^2+4a(j-c)})s^2
X\longrightarrow{X+kY}
Y\longrightarrow{Y+kX}
p,s
aX^2+bY^2+cZ^2=qXY+dXZ+tYZ
a,b,c,q,d,t
k=(q+t)^2-4b(a+c-d)
j=(d+t)^2-4c(a+b-q)
n=t(2a-t-d-q)+(2b-q)(2c-d)
X=(2n(2c-d-t)+j(q+t-2b\pm\sqrt{k}))p^2+2((d+t-2c)\sqrt{k}\mp{n})ps++(2b-q-t\pm\sqrt{k})s^2
Y=(2n(2c-d-t)+j(2(a+c-d)-q-t\pm\sqrt{k}))p^2+2((d+t-2c)\sqrt{k}\mp{ n })ps++(q+t+2(d-a-c)\pm\sqrt{k})s^2
Z=(j(q+t-2b\pm\sqrt{k})-2n(2(a+b-q)-d-t))p^2+2((2(a+b-q)-d-t)\sqrt{k}\mp{n})ps+(2b-q-t\pm\sqrt{k})s^2
X=(2n(q+t-2b)+k(2c-d-t\pm\sqrt{j}))p^2+2((2b-q-t)\sqrt{j}\mp{n})ps++(d+t-2c\pm\sqrt{j})s^2
Y=(2n(2(a+c-d)-q-t)+k(2c-d-t\pm\sqrt{j}))p^2++2((q+t+2(d-a-c))\sqrt{j}\mp{n})ps+(d+t-2c\pm\sqrt{j})s^2
Z=(2n(q+t-2b)+k(d+t+2(q-a-b)\pm\sqrt{j}))p^2+2((2b-q-t)\sqrt{j}\mp{n})ps++(2(a+b-q)-d-t\pm\sqrt{j})s^2
p,s
