\mathbb Z^2
n
n
(n^2+1)/2
(n^2+1)/2
n-1
x+ny\,\bmod\,{(n^2+1)/2}
(n^2+1)/2\ge n
n+1
0
\Delta y=(n\pm1)/2
\frac{n\pm1}2+\left|\frac{n^2+1}2-\frac{n(n\pm1)}2\right|=\frac{n\pm1}2+\frac{n\mp1}2=n\;.
\Delta y=n
y
n
n^2/2
n^2/2-n+1
n-1
n^2/2
n-1
x+(n-1)y\,\bmod\,n^2/2
n^2/2\ge n
n
0
\Delta y=n/2
n/2+n^2/2-(n-1)n/2=n
\Delta y=n/2+1
n/2+1+(n-1)(n/2+1)-n^2/2=n
\Delta y=n+1
y
