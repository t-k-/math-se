f(x) = \frac{1}{2}x^T\Gamma x + p^T x + c,\, x\in S^{n-1}
x
\nabla f(x) = P_x(\Gamma x + p)
\nabla^2 f(x) = P_x\Gamma P_x-(p^Tx+x^T\Gamma x)P_x
P_x = (I-xx^T)
x
\Gamma
\Gamma p = 0
\mathrm{Tr}(\Gamma) = 0
f, \nabla f
 \nabla^2 f
p
P_x = I - x \otimes x
T_x S^{n-1}
S^{n-1}
x
p
P_x p
\left\langle p,x\right\rangle
  p = P_x p + (I-P_x)p = P_x p + \left\langle p,x\right\rangle x, 
\left\langle p,x \right\rangle
\left\langle x,\Gamma x\right\rangle
c
\operatorname{Tr}(\Gamma)= 0
f(x)
c
 	\begin{pmatrix} \tfrac{1}{2} & 1 & 1 \\ n & n-1 & 0 \end{pmatrix} \begin{pmatrix} \left\langle x,\Gamma x\right\rangle \\ \left\langle p,x\right\rangle \\ c \end{pmatrix} = \begin{pmatrix} f(x) \\ -\operatorname{Tr}(\nabla^2 f(x)) \end{pmatrix}, 
 	 \begin{pmatrix} \left\langle x,\Gamma x\right\rangle \\ \left\langle p,x\right\rangle \end{pmatrix} = c \frac{1}{n+1} \begin{pmatrix} 2n-2 \\ -2n \end{pmatrix} + \frac{1}{n+1} \begin{pmatrix} -2n+2 & 2 \\ 2n & -1 \end{pmatrix} \begin{pmatrix} f(x) \\ -\operatorname{Tr}(\nabla^2 f(x)) \end{pmatrix}. 
P_x p
P_x \Gamma x
\nabla f(x)
0 = \Gamma p = \Gamma P_x p + \left\langle p,x\right\rangle \Gamma x
\nabla^2 f(x)
T_x S^{n-1}
T_x S^{n-1}
P_x p
P_x \Gamma x
\left\langle p,x\right\rangle
\left\langle x,\Gamma x\right\rangle
c
 P_x \Gamma x + P_x p = \nabla f(x).
 \begin{pmatrix} \nabla^2 f(x) + \left(\left\langle p,x\right\rangle + \left\langle x,\Gamma x \right\rangle\right) P_x & \left\langle p,x\right\rangle P_x \\ P_x & P_x \end{pmatrix} \begin{pmatrix} P_x p \\ P_x \Gamma x \end{pmatrix} = \begin{pmatrix} 0 \\ \nabla f(x) \end{pmatrix}, 
 \begin{pmatrix} \nabla^2 f(x) & -\left\langle x,\Gamma x\right\rangle P_x \\ P_x & P_x \end{pmatrix} \begin{pmatrix} P_x p \\ P_x \Gamma x \end{pmatrix} = \begin{pmatrix} -\left(\left\langle p,x\right\rangle + \left\langle x,\Gamma x \right\rangle\right) \nabla f(x) \\ \nabla f(x) \end{pmatrix}. 
  P_x + \left\langle x,\Gamma x\right\rangle \left(\nabla^2 f(x) \right)^{-1} 
c
p^T x
P_x p
\mathrm{Tr}(\Gamma) = 0
\mathrm{Tr}\nabla^2 f = -(n-1)(p^T x) - n(x^T\Gamma x)
P_x p
p^Tx
\Gamma
\Gamma = P_x\Gamma P_x + xx^T\Gamma P_x + P_x\Gamma xx^T + xx^T\Gamma xx^T \\ = (\nabla^2 f+\frac{p^T x-\mathrm{Tr}\nabla^2 f}{n}P_x) + (\nabla f-P_xp)x^T + x(\nabla f - P_x p)^T - \frac{\mathrm{Tr}\nabla^2 f+(n-1)p^T x}{n}xx^T
(\Gamma p)^T(\Gamma p)=0
||\nabla^2 f P_xp + \frac{p^Tx-\mathrm{Tr}(\nabla^2f)}{n}P_xp + p^Tx(\nabla f - P_xp)||^2 \\ + ||(P_xp)^T(\nabla f - P_xp)x-\frac{(n-1)(p^Tx)+\mathrm{Tr}(\nabla^2 f)}{n}(p^Tx)x||^2 = 0
\left(\nabla^2 f - \frac{n-1}{n}(p^Tx)P_x-\frac{\mathrm{Tr}(\nabla^2f)}{n}P_x\right)p + (p^Tx)\nabla f = 0
p^T(P_x p - \nabla f)+\frac{p^Tx}{n}\left(\mathrm{Tr}(\nabla^2 f)+(n-1)p^Tx\right)=0
